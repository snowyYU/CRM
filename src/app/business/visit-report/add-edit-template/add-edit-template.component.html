<div class="page-location">
  <a class="h4 pad-r-xs font-bold">{{isEdit?'修改':'新增'}}拜访报告</a>
  <a class="page-location-item"><i class="page-location-icon glyphicon glyphicon-briefcase"></i>拓展管理<i class="pad-l-min fa fa-angle-right"></i></a>
  <a class="page-location-item">拜访报告<i class="pad-l-min fa fa-angle-right"></i></a>
  <a class="page-location-item active"><span *ngIf="!isEdit">新增</span><span *ngIf="isEdit">修改</span></a>
</div>
<div class="wrapper-md">
    <form #visitReportForm="ngForm" (ngSubmit)='submit()'>
      <section class="panel-body group mar-b-sm">
        <div class="col-md-6 form-horizontal form-label-7">
          <div class="form-group">
            <label class="control-label pull-left required">客户名称：</label>
            <div class="pull-left">
              <input type="text" name="guestName" class="form-control" [(ngModel)]="guestName" [disabled]="isEdit" required (focus)="focusFun()">
            </div>
            <button type="button" class="btn btn-info mar-l-xs" [disabled]="isEdit" (click)="choose()"><i class="fa fa-user"></i>选择</button>
          </div>
          <div class="form-group">
            <label class="control-label pull-left required">拜访日期：</label>
            <div class="pull-left">
              <input type="text" name="visitDate" class="form-control" datePicker  required [(ngModel)]="visitDate" [disabled]="isEdit">
            </div>
          </div>
        </div>
        <div class="col-md-6 form-horizontal form-label-7">
          <div class="form-group">
            <label class="control-label pull-left">服务经理：</label>
            <div class="pull-left form-control-static">
              {{serviceMan}}
            </div>
          </div>
          <div class="form-group">
            <label class="control-label pull-left">拜访目的：</label>
            <div class="pull-left">
              <select name="visitWhat" required class="form-control min-width" [(ngModel)]="visitWhat" [disabled]="isEdit">
                <option [ngValue]="item.value" *ngFor="let item of visitWhatList">{{item.label}}</option>
              </select>
            </div>
          </div>
        </div>
      </section >
      <section class="panel-body group mar-b-sm">
        <div class="col-md-6 form-horizontal form-label-7">
          <div class="form-group">
            <label class="control-label pull-left required">联系人：</label>
            <div class="pull-left">
              <input type="text" name="linkName" class="form-control" [(ngModel)]="linkName" [disabled]="isEdit" required>
              <!-- <input type="text" name="linkName" class="form-control" [(ngModel)]="linkName" [disabled]="isEdit||customerDisabled" required> -->
            </div>
            <!-- <button class="btn btn-default pull-left mar-l-xs" *ngIf="customerDisabled" (click)="enable()"><i class="fa fa-pencil"></i>修改</button> -->
          </div>
          <div class="form-group">
            <label class="control-label pull-left required">联系手机：</label>
            <div class="pull-left">
              <input type="text" name="linkMobile" class="form-control" [(ngModel)]="linkMobile" [disabled]="isEdit" required>
              <!-- <input type="text" name="linkMobile" class="form-control" [(ngModel)]="linkMobile" [disabled]="isEdit||customerDisabled" required> -->
            </div>
          </div>
          <div class="form-group">
            <label class="control-label pull-left">交通：</label>
            <div class="pull-left" >
              <select name="visitVehicle" class="form-control min-width" [(ngModel)]="visitVehicle" [disabled]="isEdit" >
                <option [ngValue]="item.value" *ngFor="let item of visitVehicleList">{{item.label}}</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label pull-left required">城市：</label>
            <div class="pull-left row" style="min-width: 300px;max-width: 100%">
              <div class="col-md-6 no-r-padding">
                <select name="province" class="form-control" [(ngModel)]="province" (ngModelChange)='getCityList($event)' [disabled]="isEdit" required>
                  <!-- <select name="province" class="form-control" [(ngModel)]="province" (ngModelChange)='getCityList($event)' [disabled]="isEdit||customerDisabled" required> -->
                  <option [ngValue]='item.name' *ngFor="let item of provinceList" >{{item.name}}</option>
                </select>
              </div>
              <div class="col-md-6">
                <select name="city" class="form-control col-md-6" [(ngModel)]="city" [disabled]='!province||isEdit' required>
                  <!-- <select name="city" class="form-control col-md-6" [(ngModel)]="city" [disabled]='!province||isEdit||customerDisabled' required> -->
                  <option [ngValue]='item.name' *ngFor="let item of cityList">{{item.name}}</option>
                </select>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label pull-left required">地址：</label>
            <div class="pull-left" style="min-width: 300px;max-width: 100%">
              <input type="text" name="companyAddress" class="form-control" [(ngModel)]="companyAddress" [disabled]="isEdit" required>
              <!-- <input type="text" name="companyAddress" class="form-control" [(ngModel)]="companyAddress" [disabled]="isEdit||customerDisabled" required> -->
            </div>
          </div>
        </div>
        <div class="col-md-6 form-horizontal form-label-7">
          <div class="form-group">
            <label class="control-label pull-left required">备忘录：</label>
            <div class="pull-left form-control-static  col-md-10 no-padding" >
              <textarea name="remark"  cols="40" rows="5" class="form-control mar-b-xs"
                        [(ngModel)]="remark" placeholder="大于20字，小于200字" minlength="20" maxlength="200" required style="min-height: 175px;"></textarea>
              <div class="text-danger" *ngIf="visitReportForm.form.controls.remark&&visitReportForm.form.controls.remark.dirty&&visitReportForm.form.controls.remark.invalid">
                字数不能小于20
              </div>

            </div>
          </div>
        </div>
      </section >
  <section class="text-center">
    <button type="submit" class="btn-def mar-r-sm " [disabled]="visitReportForm.form.invalid">保存<i class="fa fa-check-circle-o"></i></button>
    <button type="button" class="btn-def" (click)="cancel()">取消<i class="fa fa-times-circle-o"></i></button>
    <a  *ngIf="showCustomerSave" href="javascript:void(0)" class="text-info" (click)="saveCustomerInfo()">保存客户信息</a>
  </section>
  </form>
</div>


<!-- 模态框部分 -->
<modal [(visible)]="customerListShow" [size]="modalSize">
  <modal-header>
    <h4 class="modal-title">选择客户</h4>
  </modal-header>
  <modal-body>
    <div class="clearfix">
        <div class="pull-left form-inline m-r-lg m-l-md" >
          <div class="radio">
            <label class="i-checks">
              <input type="radio" name="isMember" class="form-control " value="2" [(ngModel)]="isMember" (change)="getCustomerList(isMember)"><i></i> 非会员
            </label>
          </div>
        </div>
        <div class="pull-left form-inline m-r-lg" >
          <div class="radio">
            <label class="i-checks">
              <input type="radio" name="isMember" class="form-control " value="1" [(ngModel)]="isMember" (change)="getCustomerList(isMember)"><i></i> 会员
            </label>
          </div>
        </div>
      </div>
    <div class="clearfix">

      <p-dataTable tableStyleClass="table-style" [value]="dataList" [rows]="10" [paginator]="true" [pageLinks]="3" [rowsPerPageOptions]="[5,10,20]"  emptyMessage="{{loading?'':'没有查询到符合条件的记录'}}" [loading]="loading" selectionMode="single" [(selection)]="selectedCustomer">

        <p-column field="guestName" header="客户名称"></p-column>
        <!-- <p-column field="guestFromDic" header="获取途径"></p-column>
        <p-column field="companyTypeDic" header="公司类型"></p-column>
        <p-column field="statusDic" header="状态"></p-column> -->

      </p-dataTable>
    </div>
  </modal-body>
  <modal-footer styleClass="no-t-padding">
    <button class="btn btn-primary" (click)="yesModal()">确定</button>
    <button class="btn btn-default" (click)="closeModal()">关闭</button>

  </modal-footer>
</modal>
