<div class="page-location">
  <a class="h4 pad-r-xs font-bold">申请认证</a>
  <a class="page-location-item"><i class="page-location-icon glyphicon glyphicon-briefcase"></i>拓展管理<i class="pad-l-min fa fa-angle-right"></i></a>
  <a class="page-location-item">客户名册<i class="pad-l-min fa fa-angle-right"></i></a>
  <a class="page-location-item active">申请认证</a>
</div>
<div class="wrapper">
  <form #form="ngForm" (ngSubmit)="submit()" HTML5Validate>
    <section class="panel-body group mar-b-sm">
      <div class="col-md-6 form-horizontal form-label-9">
        <div class="form-group">
          <label class="control-label pull-left required">客户名称：</label>
          <div class="pull-left" style="min-width: 300px;max-width: 100%">
            <!-- <input type="text" name="guestName" class="form-control" required maxlength="50" [(ngModel)]="guestName"> -->
            <input type="text" name="guestName" class="form-control" required [(ngModel)]="guestName"
                   pattern="^.{0,50}$" #guestNameRef="ngModel"
                   [HTML5Validate]="[[guestName==='','请输入客户名称！'],[!!(guestNameRef.errors&&guestNameRef.errors.pattern),'客户名称应少于50字']]"
            />
          </div>
        </div>
        <div class="form-group">
          <label class="control-label pull-left required">获客途径：</label>
          <div class="pull-left">
            <!-- <select class="form-control min-width" name="guestFrom" required [(ngModel)]="guestFrom" (change)="appId='00001'"> -->

              <!-- <select class="form-control min-width" name="guestFrom" required [(ngModel)]="guestFrom" (change)="change()"> -->
              <select class="form-control min-width" name="guestFrom" required [(ngModel)]="guestFrom" pattern="^\S+$"
                      (change)="change()" [HTML5Validate]="[[guestFrom==='','请选择获客途径']]">
              <!-- <option [value]="undefined" hidden>请选择</option> -->
              

              <option [value]="item.value" *ngFor="let item of guest_from">{{item.label}}</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="control-label pull-left required">归属渠道：</label>
          <div class="pull-left">
            <!-- <select class="form-control min-width" name="appId" required [(ngModel)]="appId" [disabled]="guestFrom!='1'"> -->
            <select class="form-control min-width" name="appId" required [(ngModel)]="appId" [disabled]="guestFrom!='1'"
                    pattern="^\S+$" [HTML5Validate]="[[appId==='','请选择归属渠道']]">
              <!-- <option [value]="undefined" hidden>请选择</option> -->
                <option [value]="item.resourceId" *ngFor="let item of app_list">{{item.resourceName}}</option>

            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="control-label">服务经理：</label>
          <span class="form-control-static"> {{serviceMan}}</span>
        </div>
      </div>
      <div class="col-md-6 form-horizontal form-label-9">
        <div class="form-group no-b-margin">
          <label class="control-label pull-left required">类别：</label>
          <div class=" pull-left" style="width:175px;">
            <!-- <select name="memberType"  class="form-control" [(ngModel)]="memberType" required> -->
            <select name="memberType"  class="form-control" [(ngModel)]="memberType" required
                    pattern="^\S+$" [HTML5Validate]="[[memberType==='','请选择类别']]">
              <!-- <option value="-1" selected disabled hidden>请选择</option>
              <option [value]="undefined" hidden>请选择</option> -->

              <option [value]="item.value" *ngFor="let item of typeList" >{{item.label}}</option>
            </select>
          </div>
        </div>
      </div>

      <!-- <div class="col-md-6 form-horizontal form-label-9">
        <div class="form-group">
          <label class="control-label">客户名称：</label>
          <span class="form-control-static">{{guestName | filterNull:false}}</span>
        </div>
        <div class="form-group no-b-margin">
          <label class="control-label pull-left required">类别：</label>
          <div class=" pull-left" style="width:175px;">
            <select name="memberType"  class="form-control" [(ngModel)]="memberType" required>
              <option value="-1" selected disabled hidden>请选择</option>
              <option [value]="undefined" hidden>请选择</option>

              <option [value]="item.value" *ngFor="let item of typeList" >{{item.label}}</option>
            </select>
          </div>
        </div>
      </div>
      <div class="col-md-6 form-horizontal form-label-9">
        <div class="form-group">
          <label class="control-label">归属渠道：</label>
          <span class="form-control-static">  {{appName | filterNull:false}}</span>
        </div>
        <div class="form-group no-b-margin">
          <label class="control-label">服务经理：</label>
          <span class="form-control-static">  {{serviceMan | filterNull:false}}</span>
        </div>
      </div> -->
    </section >
    <section class="mar-b-sm form-horizontal form-label-9 group clearfix">
      <div class="col-md-6 ">
        <div class="form-group">
          <label class="control-label pull-left required">联系人：</label>
          <div class="pull-left">
            <!-- <input type="text" name="linkName" class="form-control " required maxlength="10" [(ngModel)]="linkName"> -->
            <input type="text" name="linkName" class="form-control" required [(ngModel)]="linkName"
                   pattern="^.{0,10}$" #linkNameRef="ngModel"
                   [HTML5Validate]="[[linkNameRef==='','请输入联系人！'],[!!(linkNameRef.errors&&linkNameRef.errors.pattern),'联系人长度应少于10字']]"
            />
          </div>
        </div>
        <div class="form-group">
          <label class="control-label pull-left required">联系人手机：</label>
          <div class="pull-left">
            <!-- <input type="number" name="linkMobile" class="form-control " required max="99999999999" [(ngModel)]="linkMobile"> -->
            <input type="text" name="linkMobile" class="form-control " required [(ngModel)]="linkMobile"
                   pattern="^1[0-9]{10}$" #linkMobileRef="ngModel"
                   [HTML5Validate]="[[linkMobileRef==='','请输入联系人手机！'],[!!(linkMobileRef.errors&&linkMobileRef.errors.pattern),'联系人手机输入有误，请输入正确的手机号码']]"
            />
          </div>
        </div>
        <div class="form-group">
          <label class="control-label pull-left required">联系人职位：</label>
          <div class="pull-left">
            <!-- <input type="text" name="linkJob" class="form-control " maxlength="20" required [(ngModel)]="linkJob"> -->
            <input type="text" name="linkJob" class="form-control" required [(ngModel)]="linkJob"
                   pattern="^.{0,20}$" #linkJobRef="ngModel"
                   [HTML5Validate]="[[linkJob==='','请输入联系人职位！'],[!!(linkJobRef.errors&&linkJobRef.errors.pattern),'联系人职位应少于20字']]"
            />
          </div>
        </div>
        <!-- <div class="form-group ">
          <label  class="control-label pull-left">联系人：</label>
          <div class="form-control-static pull-left">
            {{linkName | filterNull:false}}
          </div>
        </div>
        <div class="form-group">
          <label  class="control-label pull-left">联系手机：</label>
          <div class="form-control-static pull-left">
            {{linkMobile | filterNull:false}}
          </div>
        </div>
        <div class="form-group">
          <label  class="control-label pull-left">联系人职位：</label>
          <div class="form-control-static pull-left">
            {{linkJob | filterNull:false}}
          </div>
        </div> -->
        <div class="form-group">
          <label  class="control-label pull-left required">联系人是否法人：</label>
          <div class=" pull-left" style="width:175px;">
            <!-- <select name="isLegal"  class="form-control" [(ngModel)]="isLegal" required (change)="linkIdcard=''"> -->
            <select name="isLegal"  class="form-control" [(ngModel)]="isLegal" required (change)="linkIdcard=''"
                    pattern="^\S+$" [HTML5Validate]="[[isLegal==='','请选择联系人是否法人']]">
              <!-- <option [value]="undefined" hidden>请选择</option> -->

              <option [value]="item.value" *ngFor="let item of isLegalList" >{{item.label}}</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label  class="control-label pull-left" [class.required]="isLegal=='0'">身份证号：</label>
          <div class=" pull-left" style="width:175px;">
            <!-- <input type="text" name="linkIdcard" class="form-control" required maxlength="18" [disabled]="isLegal!=0" [(ngModel)]="linkIdcard"> -->
            <input type="text" name="linkIdcard" class="form-control" required [disabled]="isLegal!=0" 
                   [(ngModel)]="linkIdcard" pattern="^\d{17}[\dxX]$" #linkIdcardRef="ngModel" 
                   [HTML5Validate]="[[linkIdcard==='','请输入联系人身份证'],[!!(linkIdcardRef.errors&&linkIdcardRef.errors.pattern),'身份证号输入有误，请输入正确的身份证号']]"
            />
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="form-group clearfix">
          <label class="control-label pull-left required">营业执照号：</label>
          <div class="pull-left" style="min-width: 300px;max-width: 100%">
            <!-- <input type="text" name="licenceNum" class="form-control " required maxlength="30" [(ngModel)]="licenceNum"> -->
            <input type="text" name="licenceNum" class="form-control " required [(ngModel)]="licenceNum"
                   pattern="^[0-9a-zA-Z]{0,30}$" #licenceNumRef="ngModel"
                   [HTML5Validate]="[[licenceNum==='','请输入营业执照号！'],[!!(licenceNumRef.errors&&licenceNumRef.errors.pattern),'营业执照号输入有误，请输入数字或字母']]"
            />
          </div>
        </div>
        <div class="form-group">
          <label class="control-label pull-left required">公司类型：</label>
          <div class="pull-left">

            <!-- <select name="companyType"  class="form-control min-width" [(ngModel)]="companyType" required> -->
            <select name="companyType"  class="form-control min-width" [(ngModel)]="companyType" required
                    pattern="^\S+$" [HTML5Validate]="[[companyType==='','请选择公司类型']]">
              <!-- <option [value]="undefined" hidden>请选择</option> -->
              

              <option [value]="item.value" *ngFor="let item of guest_company_type">{{item.label}}</option>
            </select>
          </div>
        </div>
        <div class="form-group clearfix">
          <label class="control-label pull-left required">注册资金：</label>
          <div class="pull-left">
            <!-- <input type="number" name="registerCapital" class="form-control " max="999999999" [(ngModel)]="registerCapital" required> -->
            <input type="text" name="registerCapital" class="form-control" [(ngModel)]="registerCapital" required
                   pattern="^[0-9]{1,9}(\.[0-9]{1,2})?$" #registerCapitalRef="ngModel"
                   [HTML5Validate]="[[registerCapital==='','请输入注册资金！'],[!!(registerCapitalRef.errors&&registerCapitalRef.errors.pattern),'注册资金输入有误，请输入9位(含)以内整数,可保留两位小数']]"
            />
          </div>
          <span class="pull-left" style="padding-top: 8px;padding-left: 10px;">  万元</span>
        </div>
        <div class="form-group">
          <label class="control-label pull-left required">成立时间：</label>
          <div class="pull-left">
            <!-- <input type="text" name="foundTime" datePicker class="form-control " [opt-max]="todayDate" maxlength="10" [(ngModel)]="foundTime" required> -->
            <input type="text" name="foundTime" datePicker class="form-control" [opt-max]="todayDate" 
                   [(ngModel)]="foundTime" required autocomplete="off"
                   pattern="^[0-9]{4}\-[0-9]{2}\-[0-9]{2}$" #foundTimeRef="ngModel"
                   [HTML5Validate]="[[foundTime==='','请输入成立时间！'],[!!(foundTimeRef.errors&&foundTimeRef.errors.pattern),'成立时间输入有误，YYYY-mm-dd']]"
            />
          </div>
        </div>
        <div class="form-group clearfix">
          <label class="control-label pull-left required">公司地址：</label>
          <div class="pull-left" style="min-width: 300px;max-width: 100%;">
            <div class="row">
              <div class="col-md-6 no-r-padding">

                <!-- <select name="provnice"  class="form-control" [(ngModel)]="province" (ngModelChange)='getCityList("1")' required> -->
                  <select name="provnice"  class="form-control" [(ngModel)]="province" (ngModelChange)='getCityList("1")'        required pattern="^\S+$" [HTML5Validate]="[[province==='','请选择省份']]">
                  <!-- <option [value]="undefined" hidden>请选择</option> -->
                  

                  <option [value]='item.name' *ngFor="let item of provinceList">{{item.name}}</option>
                </select>
              </div>
              <div class="col-md-6">

                <!-- <select name="city"  class="form-control" [(ngModel)]="city" [disabled]='!province' required> -->
                <select name="city"  class="form-control" [(ngModel)]="city" [disabled]='!province' 
                        required pattern="^\S+$" [HTML5Validate]="[[city==='','请选择城市']]">
              <!-- <option [value]="undefined" hidden>请选择</option> -->
                  

                  <option [value]="item.name" *ngFor="let item of cityList">{{item.name}}</option>
                </select>
              </div>
            </div>
            <div class="row m-t-xs">
              <div class="col-md-12">
                <!-- <input placeholder="请输入详细地址" type="text" name="detailAddress" class="form-control " maxlength="180" [(ngModel)]="detailAddress" required> -->
                <input placeholder="请输入详细地址" type="text" name="detailAddress" class="form-control" 
                       [(ngModel)]="detailAddress" required
                       pattern="^.{0,180}$" #detailAddressRef="ngModel"
                       [HTML5Validate]="[[detailAddress==='','请输入详细地址！'],[!!(detailAddressRef.errors&&detailAddressRef.errors.pattern),'详细地址应少于180字']]"
                />
              </div>
            </div>
          </div>
        </div>
        <!-- <div class="form-group">
          <label  class="control-label pull-left">营业执照号：</label>
          <div class="form-control-static pull-left">
            {{licenceNum | filterNull:false}}
          </div>
        </div>
        <div class="form-group">
          <label  class="control-label pull-left">公司类型：</label>
          <div class="form-control-static pull-left">
            {{companyType | filterNull:false}}
          </div>
        </div>
        <div class="form-group">
          <label  class="control-label pull-left">注册资金：</label>
          <div class="form-control-static pull-left">
            {{registerCapital | filterNull:false | filterMultiply:0.0001 | yuanFormat:2:true}}<span *ngIf="registerCapital">万元</span>
          </div>
        </div>
        <div class="form-group">
          <label  class="control-label pull-left">成立时间：</label>
          <div class="form-control-static pull-left">
            {{foundTime | filterNull:false}}
          </div>
        </div>
        <div class="form-group clearfix">
          <label  class="control-label pull-left">公司地址：</label>
          <div class="form-control-static pull-left enter">
            {{companyAddress | filterNull:false}}
          </div>
        </div> -->
      </div>
    </section>

    <section class="group clearfix">
      <div class="group-title">附件</div>
      <!-- <div class="form-group clear-fix" *ngFor="let item of fileList"> -->
      <div class="form-group clearfix" *ngFor="let item of attachmentList;let i=index">
       <label for="" class="col-md-2 m-t-xs text-right">附件{{i+1}}</label>
       <div class="col-md-10 l-h-2x">
         <div class="col-md-3">
           <select name="firstType{{item.id}}" class="form-control" [(ngModel)]="item.firstType" (change)="item.selectFirstL()">
              <option [value]="undefined" hidden>请选择</option>

             <option [value]="type.code" *ngFor="let type of item.firstList">{{type.msg}}</option>
           </select>
         </div>
         <div class="col-md-3" >
           <select name="secondType{{item.id}}"  class="form-control" [disabled]="!item.firstType" [(ngModel)]="item.secondType" (click)="selectSecondL()">
              <option [value]="undefined" hidden>请选择</option>

             <option [value]="type.code" [hidden]="ifHidden(type.code)" *ngFor="let type of item.secondList">{{type.msg}}</option>

           </select>
         </div>


        <div class="col-md-4">
          <div *ngIf="item.uploader.queue[0]?item.uploader.queue[0].success==true:false">
            <a class="text-info inline-block" (click)="show($event,item)" textMaxLength="260px">{{item.uploader.queue[0].fileName}}</a>
          </div>
        </div>
        <div class="col-md-2">
          <div class="pull-left">
            <label class="text-info pos-rlt o-h inline-block" [class.disabled]="!item.secondType" *ngIf="!item.uploader.queue[0]" >上传
            <input type="file" accept="image/png,image/gif,image/jpg|,image/jpeg,image/bmp,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" class="uploadBtn" [uploader]="item.uploader" [disabled]="!item.secondType"/>
            <!-- <span class="file-uploader-content">上传</span> -->
          </label>
          </div>
          <div class="pull-left">
            <a *ngIf="!item.uploader.queue[0]||(item.uploader.queue[0].success)" class="text-danger m-l-sm inline-block" (click)="deleteFile(item)">删除</a>
          </div>

          <!-- 滚动条 -->
          <div *ngIf="item.uploader.queue[0]&&(!item.uploader.queue[0].success)">
            <div class="active m-b-none m-t-xs progress progress-sm progress-striped">
              <div class="progress-bar bg-success" [style.width.%]="item.uploader.queue[0].progress">
              </div>
            </div>
          </div>



        </div>

         <!-- <div class="col-md-2 m-t-xs " *ngIf="item.isUploaded">
           <a (click)="delete()" class="text-danger">删除</a>
         </div> -->
         <!-- <div class="col-md-2 p-l-none" *ngIf="item.isUploaded==false">
          <div class="btn btn-info">上传<input type="file" accept="image/png,image/gif,image/jpg|,image/jpeg,image/bmp,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" class="uploadBtn" [uploader]="item.uploader" multiple="multiple"/></div>
         </div> -->


         <!-- <div class="col-md-12 text-center text-info m-t-xs">
            <table class="form-group clearfix table table-striped m-b-none showL text-center">
                <thead>
                  <tr>
                    <th>文件名</th>
                    <th width="75">状态</th>
                    <th width="80">进度</th>
                    <th width="142">操作</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <div *ngIf="item.uploader.queue[0]?item.uploader.queue[0].success==true:false">
                        <a class="text-info" (click)="show($event,item)">{{item.uploader.queue[0].fileName}}</a>
                      </div>
                    </td>
                    <td>
                      <div *ngIf="item.uploader.queue[0]?(!item.uploader.queue[0].uploaded):true">
                        等待上传
                      </div>
                      <div *ngIf="item.uploader.queue[0]?item.uploader.queue[0].success==true:false">上传成功</div>
                      <div *ngIf="item.uploader.queue[0]?item.uploader.queue[0].error==true:false">上传失败</div>
                    </td>
                    <td>
                      <div *ngIf="item.uploader.queue[0]">
                        <div class="active m-b-none m-t-xs progress progress-sm progress-striped">
                          <div class="progress-bar bg-success" [style.width.%]="item.uploader.queue[0].progress">
                          </div>
                        </div>
                      </div>
                    </td>
                    <td>
                      <div class="btn btn-info btn-sm pos-rlt" [class.disabled]="!item.secondType" *ngIf="!item.uploader.queue[0]" >上传
                        <input type="file" accept="image/png,image/gif,image/jpg|,image/jpeg,image/bmp,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" class="uploadBtn" [uploader]="item.uploader" [disabled]="!item.secondType"/>
                      </div>
                      <div *ngIf="item.uploader.queue[0]" class="pull-left">
                        <div class="btn btn-info btn-sm pos-rlt" *ngIf="item.uploader.queue[0]">重新上传
                          <input type="file" accept="image/png,image/gif,image/jpg|,image/jpeg,image/bmp,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" class="uploadBtn" [uploader]="item.uploader" />
                        </div>
                      </div>
                      <button type="button" class="btn btn-sm btn-danger" (click)="deleteFile(item)">删除</button>
                    </td>
                  </tr>
                </tbody>
              </table>

         </div> -->
       </div>
      </div>
      <div class="col-md-2 text-info text-right padder-r">
        <a class="text-info" (click)='addAttachment()'>新增</a>
      </div>

    </section>

    <div class="col-md-12">
      <!-- <div class="text-disabled text-left pos-abt padder-l" *ngIf="!form.valid||!licenceNum||!companyType||!registerCapital||!foundTime||!companyAddress">
        提醒：请完善客户所有信息后再进行认证申请
      </div> -->
      <div class="text-center m-t-xl">
        <!-- <button class="btn-def mar-r-sm" type="submit" [disabled]="!form.valid">提交申请<i class="fa fa-check-circle-o"></i></button> -->
        <button class="btn-def mar-r-sm" type="submit">提交申请<i class="fa fa-check-circle-o"></i></button>
        <button class="btn-def" (click)="cancel()" type="button">放弃<i class="fa fa-arrow-circle-o-left"></i></button>
      </div>
    </div>
  </form>
</div>
<gallery #gallery size="md"></gallery>
<previewer [syn]="fileExtension"></previewer>
<submit-loading [show]="submitting"></submit-loading>
<!-- &&licenceNum&&companyType&&registerCapital&&foundTime&&companyAddress -->
