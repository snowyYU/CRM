<div class="page-location">
  <a class="h4 pad-r-xs font-bold">在贷跟踪</a>
  <a class="page-location-item">融资管理
    <i class="pad-l-min fa fa-angle-right"></i>
  </a>
  <a class="page-location-item active">在贷跟踪</a>
</div>
<div class="pad-l-def pad-r-def pad-b-def pad-t-sm">
  <div class="mar-b-sm form-inline">
    <label>贷款单号：</label>
    <input type="text" name="" class="form-control m-l-xs" maxlength="13" [(ngModel)]="borrowApplyId" placeholder="贷款单号" />
    <label class="m-l-md">企业名称：</label>
    <input type="text" name="" class="form-control m-l-xs" maxlength="30" [(ngModel)]="companyName" placeholder="企业名称关键字" />
    <button class="btn-def m-l-md" (click)="page=0;navigate()">查询
      <i class="fa fa-search"></i>
    </button>
  </div>
  <div class="tab-container">
    <ul class="nav nav-tabs nav-tab-info">
      <li [ngClass]="{'active':status===0}" (click)="status=0;page=0;navigate()">
        <a>全部</a>
      </li>
      <li [ngClass]="{'active':status===1}" (click)="status=1;page=0;navigate()">
        <a>即将到期</a>
      </li>
      <li [ngClass]="{'active':status===2}" (click)="status=2;page=0;navigate()">
        <a>已逾期</a>
      </li>
    </ul>
    <span class="form-inline pull-right"></span>
    <div class="tab-content">
      <div class="tab-pane active">
        <p-dataTable [value]="dataList" emptyMessage="{{loading?'':'没有查询到符合条件的记录'}}" [loading]="loading" scrollable="true" scrollHeight="375px">
          <p-column field="borrowApplyId" header="贷款单号" [style]="{'width':'130px'}"></p-column>
          <p-column header='企业名称' [style]="{'width':'120px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div textMaxLength="120px" title="{{operation.companyName}}">
                {{operation.companyName}}
              </div>
            </ng-template>
          </p-column>
          <!-- <p-column header='归属渠道' [style]="{'width':'130px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div textMaxLength="130px" title="{{operation.appName}}">
                {{operation.appName}}
              </div>
            </ng-template>
          </p-column> -->
          <!-- <p-column header="借款金额(元)" styleClass="text-right" [style]="{'width':'110px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div title="{{operation.approveAmount}}">
                {{operation.approveAmount | yuanFormat:2:true}}
              </div>
            </ng-template>
          </p-column> -->
          <p-column header="贷款产品" [style]="{'width':'100px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div textMaxLength="100px" title="{{operation.productName}}">
                {{operation.productName}}
              </div>
            </ng-template>
          </p-column>
          <p-column header="还款日" [style]="{'width':'120px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div textMaxLength="120px" title="{{operation.createTime}}">
                {{operation.createTime | effDateFormat}}
              </div>
            </ng-template>
          </p-column>
          <p-column header="应还金额(元)" [style]="{'width':'100px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div textMaxLength="100px" title="{{operation.approveAmount}}">
                {{operation.approveAmount | yuanFormat:2:true}}
              </div>
            </ng-template>
          </p-column>
          <!-- <p-column header="还款方式" [style]="{'width':'100px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div textMaxLength="100px" title="{{operation.repaymentWayDic}}">
                {{operation.repaymentWayDic}}
              </div>
            </ng-template>
          </p-column> -->
          <p-column header="状态" [style]="{'width':'100px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div textMaxLength="100px" title="{{operation.statusName}}">
                {{operation.statusName}}
              </div>
            </ng-template>
          </p-column>
          <!-- <p-column header="备注" [style]="{'width':'90px'}">
            <ng-template let-operation="rowData" pTemplate="body">
              <div textMaxLength="90px" title="{{operation.remarks}}">
                {{operation.remarks}}
              </div>
            </ng-template>
          </p-column> -->
          <p-column field="color" header="操作" [style]="{'width':'190px'}">
            <ng-template let-operation="rowData" pTemplate="body" styleClass="text-center">
              <div>
                <a class="table-btn text-info" (click)="detail(operation)">详情</a>
                <a class="table-btn text-info" (click)="getRepaymentPlanList(operation)">还款计划</a>
                <a class="table-btn text-info" (click)="detail(operation)" *ngIf="authRole.roleIn(['008'])">催收</a>
              </div>
            </ng-template>
          </p-column>

          <!-- <ng-template let-row pTemplate="rowexpansion" *ngIf='repaymentPlanList[0]'>
            <div class="ui-grid ui-grid-responsive ui-fluid">
              <div class="ui-grid-row">
                <p-dataTable tableStyleClass="table-style" [value]="repaymentPlanList">
                  <p-column field="accountId" header="期数"></p-column>
                  <p-column field="accountName" header="还款日"></p-column>
                  <p-column field="accountTypeDic" header="应还本金"></p-column>
                  <p-column field="accountTypeDic" header="应还利息"></p-column>
                  <p-column field="accountStatusDic" header="状态"></p-column>
                  <p-column field="lastTranTime" header="最后交易时间" styleClass="text-center"></p-column> 
                </p-dataTable>
              </div>
            </div>
          </ng-template> -->
          <p-footer>
            <div class="clearfix">
              <div class="pull-right">
                <paginator [(index)]="page" [count]="count" [changePageSizeAble]="true" [(pageSize)]="rows" (onChangePage)="navigate()" size="sm"
                  [showTotal]="true"></paginator>
              </div>
            </div>
          </p-footer>
        </p-dataTable>
      </div>
    </div>
  </div>
</div>